<!DOCTYPE html>
<html>
<head>
<style>
body{
    /* background-color:#271408;  */
    background-color:#61411b;
    margin: 0;
    /* background-size: auto; */
    user-select: none; /* Disables text selection */
    
    overflow: hidden;
}


#background {
    /* background-image: url(./assets/Dojo-long2x.jpg); */
    background-image: url(./assets/Dojo-long-under.jpg);
    background-repeat: no-repeat;
    /* background-size: 1550px 800px; */
    position: absolute;
    top: 0;
    left: 0;
    width: 100% ;
    height: 100%;
    /* max-width: 1301px; */
    /* max-height: 700px; */
    /* background-size:cover; */
    background-size:contain ;
    /* background-size:1400px; */
    /* background-size:; */
    z-index: -1; /* Keeps it behind other content */
}

@font-face {
    font-family: "ninja";
    src: url("./fonts/ninja-font2.ttf");
}
#indicator{
    position: absolute;
    scale: 3;
    margin-left: 260px;
    margin-top: 600px;
    color: blueviolet;
    display: none;
}
.hitBoxCords{
    position: absolute;
    scale: 1.5;
    /* margin-left: 50px; */
    /* margin-top: 460px; */
    color: yellow;
    font-weight: 900;
    /* background-color: white; */
    /* ss2 */
    display: none;
}
#playerHitBoxBox{
    position: absolute;
    scale: 1.5;
    margin-left: 50px;
    margin-top: 490px;
    color: yellow;
    font-weight: 900;
    display: none;
}
#enemyHitBoxBox{
    position: absolute;
    scale: 1.5;
    margin-right: 50px;
    margin-top: 490px;
    color: yellow;
    right: 0;
    font-weight: 900;
    display: none;
}
img,
.samuraiIdle,
.knightIdle,
.kenjiIdle,
.akazaIdle,
.samuraiAttack,
.knightAttack,
.kenjiAttack,
.samuraiDeath,
.kenjiDeath,
.samuraiTakeHit,
.kenjiTakeHit,
.samuraiFall,
.kenjiFall,
.samuraiRun,
.kenjiRun{
    position: absolute;
    display:none;
    scale: 3;
}
/* .statusMenu{
    scale: 0.5;
} */
.icon{
    position: absolute;
    height: 55px;
    z-index: 1000;
}
.healthBar1 >.icon{
    left: -75px;
    top: -15px;
}
.healthBar2 > .icon{
    right: -75px;
    top: -15px;
}
.healthBar1{
    width: 25%;
    height: 30px;
    outline: black solid 3px;
    position: absolute;
    margin: 40px;
    margin-left: 60px;
}
.healthBar2{
    width: 25%;
    height: 30px;
    outline: black solid 3px;
    position: absolute;
    margin: 40px;
    right: 0;
    margin-right: 60px;
}
#healthBarPlayer{
    position: absolute;
    height: inherit;
    width: 100%;
    background-color: red;
    left: 0;
}
#healthBarEnemy{
    position: absolute;
    height: inherit;
    width: 100%;
    background-color: red;
    right: 0;
}
.specialPower{
    position: absolute;
    height: 25px;
    z-index: 1000;
}
.healthBar1 > .specialPower{
    left: -40px;
    top: 30px;
}
.healthBar2 > .specialPower{
    right: -40px;
    transform: scaleX(-1);
    top: 30px;
}
.progress-container1 {
    width: 20%;
    background-color: transparent;
    /* border-radius: 25px; */
    /* overflow: hidden; */
    height: 15px;
    outline: black solid 3px;
    margin: 20px;
    position: absolute;
    margin-left: 40px;
    margin-left: 60px;
    margin-top: 74px;
    overflow: hidden;

}
.progress-bar1 {
    height: 100%;
    width: 0px;
    /* width: 100%; */
    background-color: #4caf50;
    transition: width 10s linear;
    overflow: hidden;
    position: absolute;
}
.glareP{
    height: 3000%;
    width: 0px;
    width: 150%;
    /* background-color: blue; */
    position: absolute;
    z-index: 20;
    rotate: 10deg;
    bottom: -20px;
    /* left: -200px; */
    /* top: 200px; */
}
.glareE{
    height: 3000%;
    width: 0px;
    width: 150%;
    /* background-color: blue; */
    position: absolute;
    z-index: 20;
    rotate: -10deg;
    bottom: -20px;
    left: -40px;
    /* top: 200px; */
    scale: -1;
}
.glareP::after{
    content: "";
    width: 10px;
    height: 100%;
    background-color: #fff;
    opacity: 1;
    position: absolute;
    animation: glare 1s linear;
    animation-direction: forwards;
    animation-iteration-count: infinite;
} 
.glareE::after{
    content: "";
    width: 10px;
    height: 100%;
    background-color: #fff;
    opacity: 1;
    position: absolute;
    animation: glare 1s linear;
    animation-direction: forwards;
    animation-iteration-count: infinite;
} 


.progress-container2 {
    width: 20%;
    background-color: transparent;
    /* border-radius: 25px; */
    /* overflow: hidden; */
    height: 15px;
    outline: black solid 3px;
    margin: 20px;
    position: absolute;
    margin-right: 40px;
    margin-right: 60px;
    margin-top: 74px;
    right: 0;
    overflow: hidden;
}

.progress-bar2 {
    position: absolute;
    height: 100%;
    width: 0;
    background-color:#333892;
    right: 0;
    transition: width 0.1s linear;
}
#time{
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    font-family: 900;
    font-size:40px;
    margin-top: 26px;
    font-family:ninja ;
    /* font-family: "Arial", sans-serif; Use a monospaced or tabular-enabled font for best results */
    font-weight: 100;
    /* color: whitesmoke; */
    letter-spacing: 0.2em; /* Adjust the value as needed */

    /* font-variant-numeric: tabular-nums; */

}
#resultIndicator{
    position: absolute;
    top: 50%;
    left: 50%;
    font-size:100px;
    margin: 0;
    text-wrap: nowrap;
    /* background-color: green; */
    transform: translate(-50%,-50%);
    display: none;
}
.flip {
  transform: scaleX(-1);
}

@keyframes flash {
  0%   {background-color: #4caf50;}
  25%  {background-color: green;}
  50%  {background-color: #4caf50;}
  75%  {background-color: green;}
  100% {background-color: #4caf50;}
}
@keyframes shine {
  0% {
    background-position: 0;
  }
  60% {
    background-position: 600px;
  }
  100% {
    background-position: 600px;
  }
}
@keyframes glare {
  from {
    left: -5%;
    opacity: 0.7;
  }
  to {
    left: 100%;
    opacity: 0.7;
  }
}
</style>
</head>
<body>
<div id="background"></div>
<!-- <p id="p" style="position: absolute;margin-left: 10px;border: 2px black solid;">A canvas element is displayed like this:</p> -->
<!-- <p id="p2" style="position: absolute;margin-right:10px;right: 0;border: 2px black solid;">A canvas element is displayed like this:</p> -->

<p id="attackRangeP" style="display: none;padding: 10px;background-color: green;position: absolute;margin-left:10px;left: 10;top:80px;border: 2px black solid;">A canvas element is displayed like this:</p>
<p id="attackRangeE" style="display: none;padding: 10px;background-color: green;position: absolute;margin-right:10px;right: 0;top:80px;border: 2px black solid;">A canvas element is displayed like this:</p>

<div class="statusMenu">

<div class="healthBar1">
    <img src = "./assets/healthIcon.png" class="icon">
    <img src = "./assets/dashIcon.png" class="specialPower">
    <div id="healthBarPlayer"></div>
</div>

<div class="healthBar2">
    <img src = "./assets/healthIcon.png" class="icon">
    <img src = "./assets/dashIcon.png" class="specialPower">
    <div id="healthBarEnemy"></div>
</div>

<div class="progress-container1">
    <div class="progress-bar1" id="specialBar1"></div>
    <div class="glareP"></div>
</div>
<div class="progress-container2">
    <div class="progress-bar2" id="specialBar2"></div>
    <div class="glareE"></div>
</div>
</div>

<p id="playerHitBoxBox">boxbox</p>
<p class="hitBoxCords" id="XL">XL</p>
<p class="hitBoxCords" id="XR">XR</p>
<p class="hitBoxCords" id="YT">YT</p>
<p class="hitBoxCords" id="YB">YB</p>
<p id="enemyHitBoxBox">Test</p>
<p class="hitBoxCords" id="XL">XL</p>
<p class="hitBoxCords" id="XR">XR</p>
<p class="hitBoxCords" id="YT">YT</p>
<p class="hitBoxCords" id="YB">YB</p>

<!-- //Samurai -->
<img  class="samuraiIdle" src="./characters/samurai/idle/idle_0.png">

<img  class="samuraiAttack"src="./characters/samurai/attack/attack_0.png">
<img  class="samuraiAttack"src="./characters/samurai/attack/attack_1.png">
<img  class="samuraiAttack"src="./characters/samurai/attack/attack_2.png">
<img  class="samuraiAttack"src="./characters/samurai/attack/attack_3.png">

<img  class="samuraiRun" src="./characters/samurai/run/run_0.png">
<img  class="samuraiRun" src="./characters/samurai/run/run_1.png">
<img  class="samuraiRun" src="./characters/samurai/run/run_2.png">
<img  class="samuraiRun" src="./characters/samurai/run/run_3.png">
<img  class="samuraiRun" src="./characters/samurai/run/run_4.png">
<img  class="samuraiRun" src="./characters/samurai/run/run_5.png">
<img  class="samuraiRun" src="./characters/samurai/run/run_6.png">
<img  class="samuraiRun" src="./characters/samurai/run/run_7.png">

<img  class="samuraiFall" src="./characters/samurai/fall/fall_0.png">

<img  class="samuraiTakeHit" src="./characters/samurai/takeHit/takeHit_0.png">
<img  class="samuraiTakeHit" src="./characters/samurai/takeHit/takeHit_1.png">
<img  class="samuraiTakeHit" src="./characters/samurai/takeHit/takeHit_2.png">

<img  class="samuraiDeath" src="./characters/samurai/death/death_0.png">
<img  class="samuraiDeath" src="./characters/samurai/death/death_1.png">
<img  class="samuraiDeath" src="./characters/samurai/death/death_2.png">
<img  class="samuraiDeath" src="./characters/samurai/death/death_3.png">
<img  class="samuraiDeath" src="./characters/samurai/death/death_4.png">
<img  class="samuraiDeath" src="./characters/samurai/death/death_5.png">

<!-- //Knight -->
<img  class="knightIdle" src="./characters/knight/idle/idle_0.png">

<img  class="knightAttack"src="./characters/knight/attack/attack_0.png">
<img  class="knightAttack"src="./characters/knight/attack/attack_1.png">
<img  class="knightAttack"src="./characters/knight/attack/attack_2.png">
<img  class="knightAttack"src="./characters/knight/attack/attack_3.png">

<img  class="knightRun" src="./characters/knight/run/run_0.png">
<img  class="knightRun" src="./characters/knight/run/run_1.png">
<img  class="knightRun" src="./characters/knight/run/run_2.png">
<img  class="knightRun" src="./characters/knight/run/run_3.png">
<img  class="knightRun" src="./characters/knight/run/run_4.png">
<img  class="knightRun" src="./characters/knight/run/run_5.png">
<img  class="knightRun" src="./characters/knight/run/run_6.png">
<img  class="knightRun" src="./characters/knight/run/run_7.png">

<img  class="knightFall" src="./characters/knight/fall/fall_0.png">

<img  class="knightTakeHit" src="./characters/knight/takeHit/takeHit_0.png">
<img  class="knightTakeHit" src="./characters/knight/takeHit/takeHit_1.png">
<img  class="knightTakeHit" src="./characters/knight/takeHit/takeHit_2.png">

<img  class="knightDeath" src="./characters/knight/death/death_0.png">
<img  class="knightDeath" src="./characters/knight/death/death_1.png">
<img  class="knightDeath" src="./characters/knight/death/death_2.png">
<img  class="knightDeath" src="./characters/knight/death/death_3.png">
<img  class="knightDeath" src="./characters/knight/death/death_4.png">
<img  class="knightDeath" src="./characters/knight/death/death_5.png">

<!-- //Kenji -->
<img  class="kenjiIdle" src="./characters/kenji/idle/idle_0.png">

<img  class="kenjiAttack"src="./characters/kenji/attack/attack_0.png">
<img  class="kenjiAttack"src="./characters/kenji/attack/attack_1.png">
<img  class="kenjiAttack"src="./characters/kenji/attack/attack_2.png">
<img  class="kenjiAttack"src="./characters/kenji/attack/attack_3.png">

<img  class="kenjiRun" src="./characters/kenji/run/run_0.png">
<img  class="kenjiRun" src="./characters/kenji/run/run_1.png">
<img  class="kenjiRun" src="./characters/kenji/run/run_2.png">
<img  class="kenjiRun" src="./characters/kenji/run/run_3.png">
<img  class="kenjiRun" src="./characters/kenji/run/run_4.png">
<img  class="kenjiRun" src="./characters/kenji/run/run_5.png">
<img  class="kenjiRun" src="./characters/kenji/run/run_6.png">
<img  class="kenjiRun" src="./characters/kenji/run/run_7.png">

<img  class="kenjiFall" src="./characters/kenji/fall/fall_0.png">

<img  class="kenjiTakeHit" src="./characters/kenji/takeHit/takeHit_0.png">
<img  class="kenjiTakeHit" src="./characters/kenji/takeHit/takeHit_1.png">
<img  class="kenjiTakeHit" src="./characters/kenji/takeHit/takeHit_2.png">

<img  class="kenjiDeath" src="./characters/kenji/death/death_0.png">
<img  class="kenjiDeath" src="./characters/kenji/death/death_1.png">
<img  class="kenjiDeath" src="./characters/kenji/death/death_2.png">
<img  class="kenjiDeath" src="./characters/kenji/death/death_3.png">
<img  class="kenjiDeath" src="./characters/kenji/death/death_4.png">
<img  class="kenjiDeath" src="./characters/kenji/death/death_5.png">

<!-- AKAZA -->
<img  class="akazaIdle" src="./characters/akaza/idle/idle_0.png">

<img  class="akazaAttack"src="./characters/akaza/attack/attack_0.png">
<img  class="akazaAttack"src="./characters/akaza/attack/attack_1.png">
<img  class="akazaAttack"src="./characters/akaza/attack/attack_2.png">
<img  class="akazaAttack"src="./characters/akaza/attack/attack_3.png">

<img  class="akazaRun" src="./characters/akaza/run/run_0.png">
<img  class="akazaRun" src="./characters/akaza/run/run_1.png">
<img  class="akazaRun" src="./characters/akaza/run/run_2.png">
<img  class="akazaRun" src="./characters/akaza/run/run_3.png">
<img  class="akazaRun" src="./characters/akaza/run/run_4.png">
<img  class="akazaRun" src="./characters/akaza/run/run_5.png">
<img  class="akazaRun" src="./characters/akaza/run/run_6.png">
<img  class="akazaRun" src="./characters/akaza/run/run_7.png">

<img  class="akazaFall" src="./characters/akaza/fall/fall_0.png">

<img  class="akazaTakeHit" src="./characters/akaza/takeHit/takeHit_0.png">
<img  class="akazaTakeHit" src="./characters/akaza/takeHit/takeHit_1.png">
<img  class="akazaTakeHit" src="./characters/akaza/takeHit/takeHit_2.png">

<img  class="akazaDeath" src="./characters/akaza/death/death_0.png">
<img  class="akazaDeath" src="./characters/akaza/death/death_1.png">
<img  class="akazaDeath" src="./characters/akaza/death/death_2.png">
<img  class="akazaDeath" src="./characters/akaza/death/death_3.png">
<img  class="akazaDeath" src="./characters/akaza/death/death_4.png">
<img  class="akazaDeath" src="./characters/akaza/death/death_5.png">


<!-- Anakin -->
<img  class="anakinIdle" src="./characters/anakin/idle/idle_0.png">

<img  class="anakinAttack"src="./characters/anakin/attack/attack_0.png">
<img  class="anakinAttack"src="./characters/anakin/attack/attack_1.png">
<img  class="anakinAttack"src="./characters/anakin/attack/attack_2.png">
<img  class="anakinAttack"src="./characters/anakin/attack/attack_3.png">

<img  class="anakinRun" src="./characters/anakin/run/run_0.png">
<img  class="anakinRun" src="./characters/anakin/run/run_1.png">
<img  class="anakinRun" src="./characters/anakin/run/run_2.png">
<img  class="anakinRun" src="./characters/anakin/run/run_3.png">
<img  class="anakinRun" src="./characters/anakin/run/run_4.png">
<img  class="anakinRun" src="./characters/anakin/run/run_5.png">
<img  class="anakinRun" src="./characters/anakin/run/run_6.png">
<img  class="anakinRun" src="./characters/anakin/run/run_7.png">

<img  class="anakinFall" src="./characters/anakin/fall/fall_0.png">

<img  class="anakinTakeHit" src="./characters/anakin/takeHit/takeHit_0.png">
<img  class="anakinTakeHit" src="./characters/anakin/takeHit/takeHit_1.png">
<img  class="anakinTakeHit" src="./characters/anakin/takeHit/takeHit_2.png">

<img  class="anakinDeath" src="./characters/anakin/death/death_0.png">
<img  class="anakinDeath" src="./characters/anakin/death/death_1.png">
<img  class="anakinDeath" src="./characters/anakin/death/death_2.png">
<img  class="anakinDeath" src="./characters/anakin/death/death_3.png">
<img  class="anakinDeath" src="./characters/anakin/death/death_4.png">
<img  class="anakinDeath" src="./characters/anakin/death/death_5.png">


<!-- Rambo -->
<img  class="ramboIdle" src="./characters/rambo/idle/idle_0.png">

<img  class="ramboAttack"src="./characters/rambo/attack/attack_0.png">
<img  class="ramboAttack"src="./characters/rambo/attack/attack_1.png">
<img  class="ramboAttack"src="./characters/rambo/attack/attack_2.png">
<img  class="ramboAttack"src="./characters/rambo/attack/attack_3.png">

<img  class="ramboRun" src="./characters/rambo/run/run_0.png">
<img  class="ramboRun" src="./characters/rambo/run/run_1.png">
<img  class="ramboRun" src="./characters/rambo/run/run_2.png">
<img  class="ramboRun" src="./characters/rambo/run/run_3.png">
<img  class="ramboRun" src="./characters/rambo/run/run_4.png">
<img  class="ramboRun" src="./characters/rambo/run/run_5.png">
<img  class="ramboRun" src="./characters/rambo/run/run_6.png">
<img  class="ramboRun" src="./characters/rambo/run/run_7.png">

<img  class="ramboFall" src="./characters/rambo/fall/fall_0.png">

<img  class="ramboTakeHit" src="./characters/rambo/takeHit/takeHit_0.png">
<img  class="ramboTakeHit" src="./characters/rambo/takeHit/takeHit_1.png">
<img  class="ramboTakeHit" src="./characters/rambo/takeHit/takeHit_2.png">

<img  class="ramboDeath" src="./characters/rambo/death/death_0.png">
<img  class="ramboDeath" src="./characters/rambo/death/death_1.png">
<img  class="ramboDeath" src="./characters/rambo/death/death_2.png">
<img  class="ramboDeath" src="./characters/rambo/death/death_3.png">
<img  class="ramboDeath" src="./characters/rambo/death/death_4.png">
<img  class="ramboDeath" src="./characters/rambo/death/death_5.png">

<!-- Law -->
<img  class="lawIdle" src="./characters/law/idle/idle_0.png">

<img  class="lawAttack"src="./characters/law/attack/attack_0.png">
<img  class="lawAttack"src="./characters/law/attack/attack_1.png">
<img  class="lawAttack"src="./characters/law/attack/attack_2.png">
<img  class="lawAttack"src="./characters/law/attack/attack_3.png">

<img  class="lawRun" src="./characters/law/run/run_0.png">
<img  class="lawRun" src="./characters/law/run/run_1.png">
<img  class="lawRun" src="./characters/law/run/run_2.png">
<img  class="lawRun" src="./characters/law/run/run_3.png">
<img  class="lawRun" src="./characters/law/run/run_4.png">
<img  class="lawRun" src="./characters/law/run/run_5.png">
<img  class="lawRun" src="./characters/law/run/run_6.png">
<img  class="lawRun" src="./characters/law/run/run_7.png">

<img  class="lawFall" src="./characters/law/fall/fall_0.png">

<img  class="lawTakeHit" src="./characters/law/takeHit/takeHit_0.png">
<img  class="lawTakeHit" src="./characters/law/takeHit/takeHit_1.png">
<img  class="lawTakeHit" src="./characters/law/takeHit/takeHit_2.png">

<img  class="lawDeath" src="./characters/law/death/death_0.png">
<img  class="lawDeath" src="./characters/law/death/death_1.png">
<img  class="lawDeath" src="./characters/law/death/death_2.png">
<img  class="lawDeath" src="./characters/law/death/death_3.png">
<img  class="lawDeath" src="./characters/law/death/death_4.png">
<img  class="lawDeath" src="./characters/law/death/death_5.png">






<!-- /////////////////////////////////////////////////////////////// -->

<h2 id="indicator"></h2>
<h2 id="resultIndicator">Player Won</h2>
<h2 id="time">60</h2>
<canvas id="canvas">Your browser does not support the HTML5 canvas tag.</canvas>
<!-- <button id="button">Press</button> -->
<script>
    let canvas;
    let context;
    let x,y;

    //Turn this to true to turn on Debugging Visualizer
    let debug = false;
        // debug = true;
    const globalCooldown = 10000;
    let countdownDuration = 60;
    let winnerDeclared = false;
    let borderRight = window.innerWidth;
    // <------------------ CHARACTER SELECT ------------------->
    // let chosenCharacter = "samurai";
    // let chosenCharacter = "kenji";
    // let chosenCharacter = "knight";
    // let chosenCharacter = "akaza";
    // let chosenCharacter = "anakin";
    // let chosenCharacter = "rambo";
    let chosenCharacter = "law";
    // <------------------ ENEMY SELECT ------------------->
    // let chosenEnemy = "samurai";
    // let chosenEnemy = "kenji";
    //let chosenEnemy = "knight";
    // let chosenEnemy = "akaza";
    // let chosenEnemy = "anakin";
    // let chosenEnemy = "rambo";
    let chosenEnemy = "law";

    scale = setScale();
    scale = 1.3;
    console.log('scale: ', scale);

    //Character width and height
    const width = 600 * scale; // Scaled width
    console.log('Character width: ', width);
    const height = 365 * scale; // Scaled height
    console.log('Character height: ', height);


    const bgElement = document.getElementById('background');

    // Get container size
    const containerWidth = bgElement.clientWidth;
    const containerHeight = bgElement.clientHeight;

    // Define intrinsic size of the background image (you must know this)
    const imageNaturalWidth = 1808;  // Example intrinsic width
    const imageNaturalHeight = 872;  // Example intrinsic height

    const containerRatio = containerWidth / containerHeight;
    const imageRatio = imageNaturalWidth / imageNaturalHeight;

    let renderedWidth, renderedHeight;

    if (imageRatio > containerRatio) {
    // Image fills width
    renderedWidth = containerWidth;
    renderedHeight = containerWidth / imageRatio;
    } else {
    // Image fills height
    renderedHeight = containerHeight;
    renderedWidth = containerHeight * imageRatio;
    }

    // Get computed width and height
    const bgWidth = renderedWidth;
    const bgHeight = renderedHeight;

    console.log('bgWidth:', bgWidth);
    console.log('bgHeight:', bgHeight);


    const keysPressed = new Set(); // Track keys pressed

    let pMoveFCounter = 0;  // Keeps track of the current frame
    let eMoveFCounter = 0;  // Keeps track of the current frame

    let pAttackFCounter = 0;  // Keeps track of the current frame
    let eAttackFCounter = 0;  // Keeps track of the current frame

    let pDeathFCounter = 0;
    let eDeathFCounter = 0;
    
    let pTakeHitFCounter = 0;
    let eTakeHitFCounter = 0;

    function User(name,x,y,dpa,maxHealth) {

        this.name = name;
        this.x = x;
        this.y = y;
        this.dpa = dpa;
        this.maxHealth = maxHealth;
        this.currentHealth = maxHealth;

        let isAttacking = false;
        let isTakingHit = false;
        let cooldown = false;
        let dashCooldown = false;
        let isMoving = false;
        let isJumping = false; 
        let isFalling = false; 
        let isDashing = false; 
        let isDead = false;
        let playingAnimation = false;

        let attackRangeS;
        let attackRangeE ;
        let attackRangeT ;
        let attackRangeB ;

        let hitBoxXL;
        let hitBoxXR;
        let hitBoxYT;
        let hitBoxYB;

        
        this.attack = function(){
            if(!this.cooldown){
                this.isAttacking = true;
                this.cooldown = true;
            }
            setTimeout(() => {
                this.isAttacking = false;
                if (this === player) {     
                    if(enemy.hitBoxXL >= player.attackRangeS && enemy.hitBoxXL <= player.attackRangeE){                        
                        if(enemy.hitBoxYB <= player.attackRangeB && enemy.hitBoxYB >= player.attackRangeT || enemy.hitBoxYT <= player.attackRangeB && enemy.hitBoxYT >= player.attackRangeT ){
                            console.log("Hit");
                            enemy.takeHit(player.dpa);       
                        }else{
                            console.log("missed Y");
                        }
                    }
                    else if(enemy.hitBoxXR >= player.attackRangeS && enemy.hitBoxXR <= player.attackRangeE){
                        if(enemy.hitBoxYB <= player.attackRangeB && enemy.hitBoxYB >= player.attackRangeT || enemy.hitBoxYT <= player.attackRangeB && enemy.hitBoxYT >= player.attackRangeT ){
                            console.log("Hit");
                            enemy.takeHit(player.dpa);       
                        }else{
                            console.log("missed Y");
                        }    
                    }
                    else{
                        console.log("Miss");
                    }
                } 
                else if (this === enemy) {
                    if(player.hitBoxXL <= enemy.attackRangeS && player.hitBoxXL >= enemy.attackRangeE){                        
                        if(player.hitBoxYB <= enemy.attackRangeB && player.hitBoxYB >= enemy.attackRangeT || player.hitBoxYT <= enemy.attackRangeB && player.hitBoxYT >= enemy.attackRangeT ){
                            console.log("Hit");
                            player.takeHit(enemy.dpa);       
                        }else{
                            console.log("missed Y");
                        }
                    }
                    else if(player.hitBoxXR <= enemy.attackRangeS && player.hitBoxXR >= enemy.attackRangeE){
                        console.log("Hit X");
                        if(player.hitBoxYB <= enemy.attackRangeB && player.hitBoxYB >= enemy.attackRangeT || player.hitBoxYT <= enemy.attackRangeB && player.hitBoxYT >= enemy.attackRangeT ){
                            console.log("Hit");
                            player.takeHit(enemy.dpa);       
                        }else{
                            console.log("missed Y");
                        }    
                    }
                    else{
                        console.log("Miss");
                    }       
                }
            }, 200); //300 for knight //200 Overall
            setTimeout(() => {
                this.cooldown = false;
            }, 500); 
        }

        this.takeHit = function(dpa){
            if(!winnerDeclared){
                this.isTakingHit = true;
                setTimeout(() => {                
                    this.currentHealth -= dpa;

                    console.log('player.currentHealth: ', player.currentHealth);
                    console.log('enemy.currentHealth: ', enemy.currentHealth);

                    healthBarEnemy.style.width = (enemy.currentHealth/enemy.maxHealth)*100 + '%';
                    healthBarPlayer.style.width = (player.currentHealth/player.maxHealth)*100 + '%';
                }, 50);
                setTimeout(() => {
                    this.isTakingHit = false;
                    pTakeHitFCounter = 0;
                    eTakeHitFCounter = 0;
                }, 400); 
            }
        }


        this.jump = function(){
            this.isJumping = true; // Set jumping state
            let counter = 0;
            const intervalId = setInterval(() => {
                if (counter < 50) { // Number of upward moves for the jump
                    this.y -= 6; // Move up gradually
                    counter++;
                } else {
                    clearInterval(intervalId); // Stop the upward movement
                    console.log("CAlling Fall()");
                    this.fall(); // Start falling back down
                }
            }, 1);
        }


        this.fall = function(){
            console.log('Falling!');
            this.isFalling = true;
            let fallCounter = 0;
            const fallIntervalId = setInterval(() => {
                if (fallCounter < 50) { // Number of downward moves
                    this.y += 6; // Move down gradually
                    fallCounter++;
                } else {
                    clearInterval(fallIntervalId); // Stop the downward movement
                    this.isJumping = false; // Reset jumping state
                    this.isFalling = false;
                }
            }, 1);
        }


        this.dash = function(){
            // If dash is on cooldown, return early
            if (this.isDashing === true || this.dashCooldown === true) {
                console.log(this.name+" is in CoolDown!");
                return;
            }
            this.isDashing = true; // Set dashing state
            this.dashCooldown = true;
            this.playingAnimation=true;
            
            if (this === player) {            
                this.x += 70*scale; // Move player position to the right
            } 
            else if (this === enemy) {
                this.x -= 70*scale; // Move player position to the left
            }
            resetCoolDown(this.name);
            this.attack();
            setTimeout(() => {
                startCoolDown(this.name);
                if (this === player) {            
                    this.x -= 70*scale; // Move back player to the left
                } 
                else if (this === enemy) {
                    this.x += 70*scale; // Move back player to the right
                }
                this.playingAnimation = false; // Animation ends
            }, 250);
            setTimeout(() => {
                this.isDashing = false; // Reset cooldown after 3 seconds
            }, 400);
        }

    }
    // player spawn locator
    // let eXSpawn = Math.floor(bgWidth/3);
    // let pXSpawn = Math.floor(bgWidth/3);
    let eXSpawn = bgWidth-(width/1.3);
    let pXSpawn = 0 - 140;
    //Why 140? Because widht/1.3 is 461 for enemy so for
    //the other side 461-600 = 139 or 140


    let eYSpawn = bgHeight-height;
    let pYSpawn = bgHeight-height;

    //Character Select Init
    //Format = (player or enemy , xcord , ycord , damage , health )
    const player = new User('player',pXSpawn,pYSpawn,25,100);
    const enemy = new User('enemy',eXSpawn,eYSpawn,25,100);

    window.onload = init;

    function init() {
        canvas = document.getElementById('canvas');

        background = document.getElementById('background');
        ///Fix For Phone Screen where height gets locked but not the IWdth
        if(window.innerWidth >= 1301){
            background.style.backgroundSize = window.innerWidth+"px"+" "+window.innerHeight+"px";
        }
        console.log('window.innerWidth: ', window.innerWidth);
        console.log('window.innerHEight: ', window.innerHeight);

        pAttackRange = document.getElementById('attackRangeP');
        eAttackRange = document.getElementById('attackRangeE');
        playerHitBoxBox = document.getElementById('playerHitBoxBox');
        pEnemyHitBoxBox = document.getElementById('enemyHitBoxBox');
        hitBoxCords = document.querySelectorAll('.hitBoxCords');
        indicator = document.getElementById("indicator");


        time = document.getElementById("time");
        resultIndicator = document.getElementById("resultIndicator");

        context = canvas.getContext('2d');

        healthBarPlayer =  document.getElementById("healthBarPlayer");
        healthBarEnemy = document.getElementById("healthBarEnemy");
        
        specialBar1 = document.getElementById('specialBar1');
        specialBar2 = document.getElementById('specialBar2');

        glareClassP = document.querySelector('.glareP');
        glareClassP.style.display = "none"; // Removes from layout
        glareClassE = document.querySelector('.glareE');
        glareClassE.style.display = "none"; // Removes from layout

        //LOAD FRAMES CHARACTER
        if(chosenCharacter === "samurai"){
            pIdle = document.querySelector(".samuraiIdle");
            pAttackF =  document.querySelectorAll(".samuraiAttack");
            pFallF = document.querySelector(".samuraiFall");
            pMoveF = document.querySelectorAll(".samuraiRun");
            pTakeHitF = document.querySelectorAll(".samuraiTakeHit");
            pDeathF = document.querySelectorAll(".samuraiDeath");
            
        }else if(chosenCharacter === "knight"){
            pIdle = document.querySelector(".knightIdle");
            pAttackF = document.querySelectorAll(".knightAttack");
            pFallF = document.querySelector(".knightFall");
            pMoveF = document.querySelectorAll(".knightRun");
            pTakeHitF = document.querySelectorAll(".knightTakeHit");
            pDeathF = document.querySelectorAll(".knightDeath");
        }else if(chosenCharacter === "kenji"){
            pIdle = document.querySelector(".kenjiIdle");
            pAttackF =  document.querySelectorAll(".kenjiAttack");
            pFallF = document.querySelector(".kenjiFall");
            pMoveF = document.querySelectorAll(".kenjiRun");
            pTakeHitF = document.querySelectorAll(".kenjiTakeHit");
            pDeathF = document.querySelectorAll(".kenjiDeath");
            
        }else if(chosenCharacter === "akaza"){
            pIdle = document.querySelector(".akazaIdle");
            pAttackF = document.querySelectorAll(".akazaAttack");
            pFallF = document.querySelector(".akazaFall");
            pMoveF = document.querySelectorAll(".akazaRun");
            pTakeHitF = document.querySelectorAll(".akazaTakeHit");
            pDeathF = document.querySelectorAll(".akazaDeath");
        }else if(chosenCharacter === "anakin"){
            pIdle = document.querySelector(".anakinIdle");
            pAttackF = document.querySelectorAll(".anakinAttack");
            pFallF = document.querySelector(".anakinFall");
            pMoveF = document.querySelectorAll(".anakinRun");
            pTakeHitF = document.querySelectorAll(".anakinTakeHit");
            pDeathF = document.querySelectorAll(".anakinDeath");
        }else if(chosenCharacter === "rambo"){
            pIdle = document.querySelector(".ramboIdle");
            pAttackF = document.querySelectorAll(".ramboAttack");
            pFallF = document.querySelector(".ramboFall");
            pMoveF = document.querySelectorAll(".ramboRun");
            pTakeHitF = document.querySelectorAll(".ramboTakeHit");
            pDeathF = document.querySelectorAll(".ramboDeath");
        }else if(chosenCharacter === "law"){
            pIdle = document.querySelector(".lawIdle");
            pAttackF = document.querySelectorAll(".lawAttack");
            pFallF = document.querySelector(".lawFall");
            pMoveF = document.querySelectorAll(".lawRun");
            pTakeHitF = document.querySelectorAll(".lawTakeHit");
            pDeathF = document.querySelectorAll(".lawDeath");
        }
        //LOAD FRAMES ENEMY
        if(chosenEnemy === "kenji"){
            eIdle = document.querySelector(".kenjiIdle");
            eAttackF =  document.querySelectorAll(".kenjiAttack");
            eFallF = document.querySelector(".kenjiFall");
            eMoveF = document.querySelectorAll(".kenjiRun");
            eTakeHitF = document.querySelectorAll(".kenjiTakeHit");
            eDeathF = document.querySelectorAll(".kenjiDeath");
            console.log("LOADED ENEMY kenji");
            
        }else if(chosenEnemy === "samurai"){
            eIdle = document.querySelector(".samuraiIdle");
            eAttackF =  document.querySelectorAll(".samuraiAttack");
            eFallF = document.querySelector(".samuraiFall");
            eMoveF = document.querySelectorAll(".samuraiRun");
            eTakeHitF = document.querySelectorAll(".samuraiTakeHit");
            eDeathF = document.querySelectorAll(".samuraiDeath");
            console.log("LOADED ENEMY samurai");
            
        }
        else if(chosenEnemy === "akaza"){
            eIdle = document.querySelector(".akazaIdle");
            eAttackF =  document.querySelectorAll(".akazaAttack");
            eFallF = document.querySelector(".akazaFall");
            eMoveF = document.querySelectorAll(".akazaRun");
            eTakeHitF = document.querySelectorAll(".akazaTakeHit");
            eDeathF = document.querySelectorAll(".akazaDeath");
            console.log("LOADED ENEMY akaza");
        }
        else if(chosenEnemy === "knight"){
            eIdle = document.querySelector(".knightIdle");
            eAttackF =  document.querySelectorAll(".knightAttack");
            eFallF = document.querySelector(".knightFall");
            eMoveF = document.querySelectorAll(".knightRun");
            eTakeHitF = document.querySelectorAll(".knightTakeHit");
            eDeathF = document.querySelectorAll(".knightDeath");
            console.log("LOADED ENEMY knight");
        }
        else if(chosenEnemy === "anakin"){
            eIdle = document.querySelector(".anakinIdle");
            eAttackF =  document.querySelectorAll(".anakinAttack");
            eFallF = document.querySelector(".anakinFall");
            eMoveF = document.querySelectorAll(".anakinRun");
            eTakeHitF = document.querySelectorAll(".anakinTakeHit");
            eDeathF = document.querySelectorAll(".anakinDeath");
            console.log("LOADED ENEMY anakin");
        }else if(chosenCharacter === "rambo"){
            eIdle = document.querySelector(".ramboIdle");
            eAttackF = document.querySelectorAll(".ramboAttack");
            eFallF = document.querySelector(".ramboFall");
            eMoveF = document.querySelectorAll(".ramboRun");
            eTakeHitF = document.querySelectorAll(".ramboTakeHit");
            eDeathF = document.querySelectorAll(".ramboDeath");
        }else if(chosenCharacter === "law"){
            eIdle = document.querySelector(".lawIdle");
            eAttackF = document.querySelectorAll(".lawAttack");
            eFallF = document.querySelector(".lawFall");
            eMoveF = document.querySelectorAll(".lawRun");
            eTakeHitF = document.querySelectorAll(".lawTakeHit");
            eDeathF = document.querySelectorAll(".lawDeath");
        }
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;


        // Track keydown and keyup events
        window.addEventListener('keydown', (event) => {
            keysPressed.add(event.key);
        });
        window.addEventListener('keyup', (event) => {
            keysPressed.delete(event.key);
        });

        // Start the game loop
        window.requestAnimationFrame(gameLoop);
        // Moving and Attacking Frame Interval
        setInterval(() => {
            if(player.isMoving){
                pMoveFCounter = (pMoveFCounter + 1) % (pMoveF.length);  
            }
            if(enemy.isMoving){
                eMoveFCounter = (eMoveFCounter + 1) % (eMoveF.length);  
            }
            if(enemy.isAttacking){
                eAttackFCounter = (eAttackFCounter+1) % (eAttackF.length);
            }
            if(player.isAttacking){
                pAttackFCounter = (pAttackFCounter+1) % (pAttackF.length);

            }
            
        }, 50);
        //Taking Hit Frame Interval
        setInterval(() => {
            if(player.isTakingHit){
                pTakeHitFCounter = (pTakeHitFCounter+1) % (pTakeHitF.length);
            }
            if(enemy.isTakingHit){
                eTakeHitFCounter = (eTakeHitFCounter+1) % (eTakeHitF.length);
            }
            if(player.isDead){
                if(pDeathFCounter < 5){
                    pDeathFCounter++;
                }
            }
            if(enemy.isDead){
                if(eDeathFCounter < 5){
                    eDeathFCounter++;
                }
            }
        }, 200);
        
        startCountdown();

        // Initial Cooldown
        player.dashCooldown = true;
        enemy.dashCooldown = true;
        setTimeout(() => {
            player.dashCooldown = false;
            enemy.dashCooldown = false;
            console.log("Initial Cool DOwn Ended!");
        }, globalCooldown);

        startCoolDown("player");
        startCoolDown("enemy");

    }

    function gameLoop(timeStamp) {
        // Clear the canvas for each frame
        context.clearRect(0, 0, canvas.width, canvas.height);

        characterMovement(player, {left: 'a',right: 'd',attack: 's',jump: 'w',dash: ' ',});
        characterMovement(enemy, {left: 'ArrowLeft',right: 'ArrowRight',attack: 'ArrowDown',jump: 'ArrowUp',dash: 'Enter',});
        
        //Render BOTH
        playerDraw();
        enemyDraw();

        if(!winnerDeclared){
            
            checkHealth();   
            
            getPlayerAttackBoxAndHitBox();
            getEnemyAttackBoxAndHitBox();
        }

        if(debug === true){
            debugPlayerAttackBoxAndHitBox();
            debugEnemyAttackBoxAndHitBox();
            for (let i = 0; i < 8; i++) { // Loop from 0 to 7
                hitBoxCords[i].style.display = "block";
            }
            playerHitBoxBox.style.display = "block";
            enemyHitBoxBox.style.display = "block";
            // pAttackRange.style.display = "block";
            // eAttackRange.style.display = "block";
            indicator.style.display = "block";
        }
        
        window.requestAnimationFrame(gameLoop); // Keep requesting new frames
    }
    function playerDraw(){
        if (player.isDead){
            drawDeath(pDeathF[pDeathFCounter],player.x,player.y);
            return;
        }
        if (player.isAttacking){
            drawAttack(pAttackF[pAttackFCounter],player.x,player.y); 
        }
        if (player.isTakingHit && !player.isAttacking){
            drawTakeHit(pTakeHitF[pTakeHitFCounter],player.x,player.y); 
        }
        else if (player.isMoving && !player.isAttacking) {
            drawMove(pMoveF[pMoveFCounter],player.x,player.y);
        } 
        else if (player.isFalling) {
            drawFall(pFallF,player.x,player.y);
        } 
        else if(!player.isAttacking && !player.isFalling && !player.isMoving && !player.isDashing && !player.isDead) { 
            drawIdle(pIdle,player.x,player.y,"player"); 
        }
    }

    function enemyDraw(){
        if (enemy.isDead) {
            drawDeath(eDeathF[eDeathFCounter],enemy.x,enemy.y,"enemy");
            return;
        }
        if (enemy.isAttacking){   
            drawAttack(eAttackF[eAttackFCounter],enemy.x,enemy.y,"enemy"); 
        }
        if (enemy.isTakingHit && !enemy.isAttacking){
            drawTakeHit(eTakeHitF[eTakeHitFCounter],enemy.x,enemy.y,"enemy"); 
        }
        else if (enemy.isMoving && !enemy.isAttacking) {
            drawMove(eMoveF[eMoveFCounter],enemy.x,enemy.y,"enemy");
        } 
        else if (enemy.isFalling) {
            drawFall(eFallF,enemy.x,enemy.y,"enemy");
        } 
        else if(!enemy.isAttacking && !enemy.isFalling && !enemy.isMoving && !enemy.isDashing && !enemy.isDead) { 
            drawIdle(eIdle,enemy.x,enemy.y,"enemy"); 
        }
    }

    function characterMovement(character, controls) {
        const { left, right, attack, jump, dash } = controls;

        if (keysPressed.has(right) && character.hitBoxXR < borderRight && !character.playingAnimation && !character.isDead) {
            character.x += 15;
        }
        if (keysPressed.has(left) && character.hitBoxXL > 0 && !character.playingAnimation && !character.isDead) {
            character.x -= 15;
        }
        if (keysPressed.has(left) || keysPressed.has(right)) {
            character.isMoving = true;
        } else {
            character.isMoving = false;
        }
        if (keysPressed.has(left) && keysPressed.has(right)) {
            character.isMoving = false;
        }
        if (keysPressed.has(attack) && !character.playingAnimation && !character.isAttacking && !character.cooldown && !character.isDead) {
            character.attack();
        }
        if (keysPressed.has(jump) && !character.isJumping && !character.isDead) character.jump();
        if (keysPressed.has(dash) && !character.isDashing &&!character.dashCooldown && !character.isAttacking && !character.isDead) character.dash();
    }

    function checkHealth(){
        indicator.innerText = "Enemy:"+enemy.currentHealth+" Player:"+player.currentHealth;
        if(enemy.currentHealth <= 0 ){
            enemy.isDead = true;
            console.log("Enemy Dead");
            indicator.innerText = "Enemy Dead";
            healthBarEnemy.style.width = 0;   
            winnerDeclared = true;
            showResult("Player");
        }
        if(player.currentHealth <= 0){
            player.isDead = true;
            console.log("Player Dead");
            indicator.innerText = "Player Dead";
            healthBarPlayer.style.width = 0;   
            winnerDeclared = true;
            showResult("Enemy");
        }
        if(enemy.currentHealth === player.currentHealth && countdownDuration === 0){
            console.log('showResult: Tie');
            winnerDeclared = true;
            showResult("Tie");
        }
        if(enemy.currentHealth < player.currentHealth && countdownDuration === 0){
            winnerDeclared = true;
            showResult("Player");
        }
        if(player.currentHealth < enemy.currentHealth && countdownDuration === 0){
            winnerDeclared = true;
            showResult("Enemy");
        }
    }

    //FLip when enemy calls this function
    function drawIdle(charImg, x, y, name) {
        if(name === "enemy"){
            context.save();
            context.translate(x + width, y);
            context.scale(-1, 1);
            context.drawImage(charImg, 0, 0, width, height);
            context.restore();
        }else{
            context.drawImage(charImg, x, y, width, height);
            
        }

    }

    function drawAttack(charAttack,x, y, name) {
        if(name === "enemy"){
            context.save();
            context.translate(x + width, y);
            context.scale(-1, 1);
            context.drawImage(charAttack, 0, 0, width, height);
            context.restore();
        }else{
            context.drawImage(charAttack, x, y, width, height);
            
        }
    }
    
    function drawTakeHit(charTakeHit,x, y, name) {
        if(name === "enemy"){
            context.save();
            context.translate(x + width, y);
            context.scale(-1, 1);
            console.log('charTakeHit: ', charTakeHit);
            context.drawImage(charTakeHit, 0, 0,width,height); // Draw the scaled image
            context.restore();
        }else{
            console.log('charTakeHit: ', charTakeHit);
            context.drawImage(charTakeHit, x, y,width,height); // Draw the scaled image
            
        }
    }
    
    function drawMove(charImgMove,x,y, name){
        if(name === "enemy"){
            context.save();
            context.translate(x + width, y);
            context.scale(-1, 1);
            context.drawImage(charImgMove, 0, 0,width,height); // Draw the scaled image
            context.restore();
        }else{
            context.drawImage(charImgMove, x, y,width,height); // Draw the scaled image
            
        }
    }
    
    function drawFall(charFall,x,y, name){
        if(name === "enemy"){
            context.save();
            context.translate(x + width, y);
            context.scale(-1, 1);
            context.drawImage(charFall, 0, 0,width,height); // Draw the scaled image
            context.restore();
        }else{
            context.drawImage(charFall, x, y,width,height); // Draw the scaled image
            
        }
    }
    
    function drawDeath(charDeath,x,y, name){
        if(name === "enemy"){
            context.save();
            context.translate(x + width, y);
            context.scale(-1, 1);
            context.drawImage(charDeath, 0, 0,width,height); // Draw the scaled image
            context.restore();
        }else{
            context.drawImage(charDeath, x, y,width,height); // Draw the scaled image
            
        }
    }
    
    function getPlayerAttackBoxAndHitBox(){
        
        //Left X
        player.hitBoxXL = Math.floor(player.x +(width/2.5));
        //Right X
        player.hitBoxXR = Math.floor(player.x+(width/1.75));
        //Top Y
        player.hitBoxYT = Math.floor(player.y+(height/2));
        //Bottom Y
        player.hitBoxYB = Math.floor(player.y+height);
        
        player.attackRangeS = player.hitBoxXR;
        player.attackRangeE = player.attackRangeS + (width/3);
        player.attackRangeT = player.hitBoxYT;
        player.attackRangeB = player.hitBoxYB;
    }
    function debugPlayerAttackBoxAndHitBox(){
        //Player AttackBox
        context.lineWidth = "6";
        context.strokeStyle = "red";
        
        context.strokeRect(player.attackRangeS,player.hitBoxYT,1,player.hitBoxYB-player.hitBoxYT);
        context.strokeRect(player.attackRangeE,player.hitBoxYT,1,player.hitBoxYB-player.hitBoxYT);
        context.strokeRect(player.attackRangeS,player.attackRangeT,player.attackRangeE-player.attackRangeS,1);
        context.strokeRect(player.attackRangeS,player.attackRangeB,player.attackRangeE-player.attackRangeS,1);
        
        pAttackRange.innerText = "Attack Range:"+"\n"+"X : "+player.attackRangeS +"-"+player.attackRangeE +" ("+(player.attackRangeE-player.attackRangeS)+")"+"\n"+"Y : "+player.attackRangeT+"-"+player.attackRangeB ;

        //Player HitBox
        context.lineWidth = "6";
        context.strokeStyle = "green";

        //Left X
            context.strokeRect(player.hitBoxXL,player.y+(height/1.3), 1,1);
            hitBoxCords[2].style.top = player.y+(height/1.3)+"px";
            hitBoxCords[2].style.left = player.hitBoxXL+"px";
            hitBoxCords[2].innerText = player.hitBoxXL;
        
        // //Right X
            context.strokeRect(player.hitBoxXR,player.y+(height/1.3), 1,1);
            hitBoxCords[3].style.top = player.y+(height/1.3)+"px";
            hitBoxCords[3].style.left = player.hitBoxXR+"px";
            hitBoxCords[3].innerText = player.hitBoxXR;
            
        // //Top Y
            context.strokeRect(player.x+(width/2),player.hitBoxYT, 1,1);
            hitBoxCords[0].style.top = player.hitBoxYT+"px";
            hitBoxCords[0].style.left = player.x+(width/2)+"px";
            hitBoxCords[0].innerText = player.hitBoxYT;

        // //Bottom Y
            context.strokeRect((player.x+(width/2)),player.hitBoxYB, 1,1);
            hitBoxCords[1].style.top = player.hitBoxYB+"px";
            hitBoxCords[1].style.left = player.x+(width/2)+"px";
            hitBoxCords[1].innerText = player.hitBoxYB;
            

        playerHitBoxBox.innerText = "Left X:"+player.hitBoxXL+"\n"+"Right X:"+player.hitBoxXR+"\n"+"Top Y:"+player.hitBoxYT+"\n"+"Bottom Y:"+player.hitBoxYB;
    
    
    
        context.lineWidth = "5";
        context.strokeStyle = "blue";
        context.strokeRect(player.x,player.y,width,height);

    
    
    }
    function getEnemyAttackBoxAndHitBox(){

        //Left X 
        enemy.hitBoxXL = Math.floor(enemy.x+(width/2.5));
        //Right X
        enemy.hitBoxXR = Math.floor(enemy.x+(width/1.75));
        //Top Y
        enemy.hitBoxYT = Math.floor(enemy.y+(height/2));
        //Bottom Y
        enemy.hitBoxYB = Math.floor(enemy.y+height);
        
        enemy.attackRangeS = enemy.hitBoxXL;
        enemy.attackRangeE = enemy.attackRangeS - (width/3);
        enemy.attackRangeT = enemy.hitBoxYT;
        enemy.attackRangeB = enemy.hitBoxYB;


    }
    function debugEnemyAttackBoxAndHitBox(){
        //Enemy AttackBox
        context.lineWidth = "6";

        context.strokeStyle = "red";

        context.strokeRect(enemy.attackRangeS,enemy.hitBoxYT,1,enemy.hitBoxYB-enemy.hitBoxYT);
        context.strokeRect(enemy.attackRangeE,enemy.hitBoxYT,1,enemy.hitBoxYB-enemy.hitBoxYT);
        context.strokeRect(enemy.attackRangeS,enemy.attackRangeT,enemy.attackRangeE-enemy.attackRangeS,1);
        context.strokeRect(enemy.attackRangeS,enemy.attackRangeB,enemy.attackRangeE-enemy.attackRangeS,1);

        eAttackRange.innerText = "Attack Range:"+"\n"+"X : "+enemy.attackRangeS +"-"+enemy.attackRangeE +" ("+(enemy.attackRangeS-enemy.attackRangeE)+")"+"\n"+"Y : "+enemy.attackRangeT+"-"+enemy.attackRangeB ;

        //Enemy HitBox    
            context.lineWidth = "6";
            context.strokeStyle = "blue";
        //Left X 
            context.strokeRect(enemy.hitBoxXL,enemy.y+(height/1.3), 1,1);
            hitBoxCords[2].style.top = enemy.y+(height/1.3)+"px";
            hitBoxCords[2].style.left = enemy.hitBoxXL+"px";
            hitBoxCords[2].innerText = enemy.hitBoxXL;
        // //Right X
            context.strokeRect(enemy.hitBoxXR,enemy.y+(height/1.3), 1,1);
            hitBoxCords[3].style.top = enemy.y+(height/1.3)+"px";
            hitBoxCords[3].style.left = enemy.hitBoxXR+"px";
            hitBoxCords[3].innerText = enemy.hitBoxXR;
            
        // //Top Y
            context.strokeRect(enemy.x+(width/2),enemy.hitBoxYT, 1,1);
            hitBoxCords[0].style.top = enemy.hitBoxYT+"px";
            hitBoxCords[0].style.left = enemy.x+(width/2)+"px";
            hitBoxCords[0].innerText = enemy.hitBoxYT;

        // //Bottom Y
            context.strokeRect((enemy.x+(width/2)),enemy.hitBoxYB, 1,1);
            hitBoxCords[1].style.top = enemy.hitBoxYB+"px";
            hitBoxCords[1].style.left = enemy.x+(width/2)+"px";
            hitBoxCords[1].innerText = enemy.hitBoxYB;
            
        pEnemyHitBoxBox.innerText = "Left X:"+enemy.hitBoxXL+"\n"+"Right X:"+enemy.hitBoxXR+"\n"+"Top Y:"+enemy.hitBoxYT+"\n"+"Bottom Y:"+enemy.hitBoxYB;    


        context.lineWidth = "5";
        context.strokeStyle = "blue";
        context.strokeRect(enemy.x,enemy.y,width,height);
    }

    function startCountdown(){
        const interval = setInterval(() => {
            countdownDuration--;

            // Update the display
            time.innerText = countdownDuration;

            // Stop the countdown when it reaches 0
            if (countdownDuration <= 0) {
                clearInterval(interval);
            }
        }, 1000);
    }
    function resetCoolDown(name) {
        console.log("Reset CoolDown:"+name);
        if(name === "player"){
            glareClassP.style.display = "none"; // Removes from layout
            specialBar1.style.transition = "width 0.1s linear";
            specialBar1.style.width = 0 + '%';
        }
        if(name === "enemy"){
            glareClassE.style.display = "none"; // Removes from layout
            specialBar2.style.transition = "width 0.1s linear";
            specialBar2.style.width = 0 + '%';
        }
    }
    function startCoolDown(name){
        console.log("Start CoolDown:"+name);
        if(name === "player"){
            specialBar1.style.transition = "width 10s linear";
            specialBar1.style.width = 100 + '%';
            setTimeout(() => {
                glareClassP.style.display = "block"; // Removes from layout
                player.dashCooldown = false; // Reset cooldown after 3 seconds
            }, globalCooldown);
        }
        if(name === "enemy"){
            specialBar2.style.transition = "width 10s linear";
            specialBar2.style.width = 100 + '%';
            setTimeout(() => {
                glareClassE.style.display = "block"; // Removes from layout
                enemy.dashCooldown = false; // Reset cooldown after 3 seconds
            }, globalCooldown);
        }
    }
    function showResult(winner){
        if(winner != "Tie"){
            resultIndicator.innerText = winner + "Won!";
            resultIndicator.style.display = "block";
            return;
        }
        if(countdownDuration === 0){
            resultIndicator.innerText = "I's a Tie!";
            resultIndicator.style.display = "block";

        }
    }
    function setScale() {
        if (window.innerWidth > 1300) {
            // return 4.75;
            return 5.4;
        // } else if (window.innerWidth > 1420 && window.innerWidth <= 1440) {
        //     return 4.7;
        // } else if (window.innerWidth > 1400 && window.innerWidth <= 1420) {
        //     return 4.65;
        // } else if (window.innerWidth > 1380 && window.innerWidth <= 1400) {
        //     return 4.6;
        // } else if (window.innerWidth > 1360 && window.innerWidth <= 1380) {
        //     return 4.55;
        // } else if (window.innerWidth > 1340 && window.innerWidth <= 1360) {
        //     return 4.5;
        // } else if (window.innerWidth > 1320 && window.innerWidth <= 1340) {
        //     return 4.45;
        // } else if (window.innerWidth > 1300 && window.innerWidth <= 1320) {
        //     return 4.4;
        } else if (window.innerWidth > 1280 && window.innerWidth <= 1300) {
            return 5.35;
        } else if (window.innerWidth > 1260 && window.innerWidth <= 1280) {
            return 5.2;
        } else if (window.innerWidth > 1240 && window.innerWidth <= 1260) {
            return 4.95;
        } else if (window.innerWidth > 1220 && window.innerWidth <= 1240) {
            return 4.85;
        } else if (window.innerWidth > 1200 && window.innerWidth <= 1220) {
            return 4.75;
        } else if (window.innerWidth > 1180 && window.innerWidth <= 1200) {
            return 4.65;
        } else if (window.innerWidth > 1160 && window.innerWidth <= 1180) {
            return 4.55;
        } else if (window.innerWidth > 1140 && window.innerWidth <= 1160) {
            return 4.45;
        } else if (window.innerWidth > 1120 && window.innerWidth <= 1140) {
            return 4.35;
        } else if (window.innerWidth > 1100 && window.innerWidth <= 1120) {
            return 4.25;
        } else if (window.innerWidth > 1080 && window.innerWidth <= 1100) {
            return 4.15;
        } else if (window.innerWidth > 1060 && window.innerWidth <= 1080) {
            return 4.1;
        } else if (window.innerWidth > 1040 && window.innerWidth <= 1060) {
            return 4.05;
        } else if (window.innerWidth > 1020 && window.innerWidth <= 1040) {
            return 4;
        } else if (window.innerWidth > 1000 && window.innerWidth <= 1020) {
            return 3.95;
        } else if (window.innerWidth > 980 && window.innerWidth <= 1000) {
            return 3.9;
        } else if (window.innerWidth > 960 && window.innerWidth <= 980) {
            return 3.85;
        } else if (window.innerWidth > 940 && window.innerWidth <= 960) {
            return 3.8;
        } else if (window.innerWidth > 900 && window.innerWidth <= 940) {
            return 3.6;
        } else if (window.innerWidth > 880 && window.innerWidth <= 900) {
            return 3.5;
        } else if (window.innerWidth > 860 && window.innerWidth <= 880) {
            return 3.4;
        } else if (window.innerWidth > 840 && window.innerWidth <= 860) {
            return 3.3;
        } else if (window.innerWidth > 820 && window.innerWidth <= 840) {
            return 3.25;
        } else if (window.innerWidth > 800 && window.innerWidth <= 820) {
            return 3.2;
        } else if (window.innerWidth > 780 && window.innerWidth <= 800) {
            return 3.15;
        } else if (window.innerWidth > 760 && window.innerWidth <= 780) {
            return 3;
        } else if (window.innerWidth > 740 && window.innerWidth <= 760) {
            return 2.95;
        } else if (window.innerWidth > 720 && window.innerWidth <= 740) {
            return 2.9;
        } else if (window.innerWidth > 700 && window.innerWidth <= 720) {
            return 2.85;
        } else if (window.innerWidth > 680 && window.innerWidth <= 700) {
            return 2.75;
        } else if (window.innerWidth > 660 && window.innerWidth <= 680) {
            return 2.7;
        } else if (window.innerWidth > 640 && window.innerWidth <= 660) {
            return 2.65;
        } else if (window.innerWidth > 620 && window.innerWidth <= 640) {
            return 2.6;
        } else if (window.innerWidth > 600 && window.innerWidth <= 620) {
            return 2.5;
        } else if (window.innerWidth > 580 && window.innerWidth <= 600) {
            return 2.4;
        } else if (window.innerWidth > 560 && window.innerWidth <= 580) {
            return 2.35;
        } else if (window.innerWidth > 540 && window.innerWidth <= 560) {
            return 2.3;
        } else if (window.innerWidth > 520 && window.innerWidth <= 540) {
            return 2.25;
        } else if (window.innerWidth > 500 && window.innerWidth <= 520) {
            return 2.15;
        } else if (window.innerWidth > 480 && window.innerWidth <= 500) {
            return 2.1;
        } else if (window.innerWidth > 460 && window.innerWidth <= 480) {
            return 2;
        } else if (window.innerWidth > 440 && window.innerWidth <= 460) {
            return 2;
        } else if (window.innerWidth > 420 && window.innerWidth <= 440) {
            return 1.95;
        } else if (window.innerWidth > 400 && window.innerWidth <= 420) {
            return 1.9;
        } else if (window.innerWidth > 380 && window.innerWidth <= 400) {
            return 1.85;
        } else if (window.innerWidth > 360 && window.innerWidth <= 380) {
            return 1.8;
        } else {
            return 1.75; // For anything below 360px
        }

    }

</script>

</body>
</html>
